const _0x16c8d9=_0x2801;(function(_0x455957,_0x12baff){const _0x3a985b=_0x2801,_0x9a3f3f=_0x455957();while(!![]){try{const _0xb407f1=-parseInt(_0x3a985b(0xce))/0x1+-parseInt(_0x3a985b(0xc4))/0x2+-parseInt(_0x3a985b(0xd3))/0x3+parseInt(_0x3a985b(0xbe))/0x4+-parseInt(_0x3a985b(0xc3))/0x5+-parseInt(_0x3a985b(0xb8))/0x6+parseInt(_0x3a985b(0xa7))/0x7*(parseInt(_0x3a985b(0xb6))/0x8);if(_0xb407f1===_0x12baff)break;else _0x9a3f3f['push'](_0x9a3f3f['shift']());}catch(_0x3dd3af){_0x9a3f3f['push'](_0x9a3f3f['shift']());}}}(_0x56dd,0x2031a));import*as _0x131937 from'@tensorflow/tfjs';import{PsySegBuf,ColorSpaceType}from'../PsySeg.js';function _0x2801(_0x279fb9,_0x5c55c4){const _0x56ddb3=_0x56dd();return _0x2801=function(_0x2801fd,_0x1413fb){_0x2801fd=_0x2801fd-0xa7;let _0x2aa556=_0x56ddb3[_0x2801fd];return _0x2aa556;},_0x2801(_0x279fb9,_0x5c55c4);}import{preProcessing}from'../Preprocessing/Preprocessing.js';import _0x4a4110 from'wasm-feature-detect';import _0x1c8918 from'../model/tflite-import/tflite.js';import _0x56bab8 from'../model/tflite-import/tflite-simd.js';_0x16c8d9(0xe0);function _0x56dd(){const _0x4553f3=['segHeight','bind','setBackend','_runInference','_getInputHeight','initTime','29533tgzMhn','catch','default','cast','_getInputChannelCount','333459iaNxKT','model','run','getBackend','Model\x20load\x20result:','segWidth','Input\x20width:','Create\x20tflite\x20module\x20failed\x20due\x20to\x20','type','argMax','Output\x20channels:','Cannot\x20get\x20inference\x20due\x20to\x20','dispose','use\x20strict','_getOutputMemoryOffset','tflite','browser','loadTfJsModel','runTFLiteInference','_getOutputHeight','_getOutputChannelCount','tfjs','data','28VhSUgR','loadTfLiteModel','expandDims','HEAPF32','COLOR_SPACE_RGBA','_getInputMemoryOffset','int32','width','Output\x20memory\x20offset:','greater','Cannot\x20check\x20SIMD\x20support\x20by\x20browsers\x20due\x20to\x20','Cannot\x20get\x20alpha\x20mask\x20due\x20to\x20DNN\x20issue\x20','then','log','webgl','1201352fNnUOi','Input\x20channels:','956448IksKmD','exp','equal','logicalOr','runTFJSInference','https://psyjs-cdn.nuvixa.com/model.json','558964vgvGHE','Model\x20buffer\x20memory\x20offset:','startTime','now','Output\x20width:','1317590UVwDEA','89878tNdIoR','fromPixels','height','modeling\x20model'];_0x56dd=function(){return _0x4553f3;};return _0x56dd();}var TfLiteModel=null,TfJsModel=null;export class SmartEyes{constructor(_0x42b364,_0xabeea0){const _0x1b16bc=_0x16c8d9;this[_0x1b16bc(0xc0)]=Date[_0x1b16bc(0xc1)](),this[_0x1b16bc(0xcd)]=0x0,this[_0x1b16bc(0xd4)]=null,this[_0x1b16bc(0xdb)]=_0x42b364===_0x1b16bc(0xe2)?_0x1b16bc(0xe2):_0x1b16bc(0xe8),this['segWidth']=_0x42b364==='tflite'?0xa0:0xc0,this[_0x1b16bc(0xc8)]=_0x42b364===_0x1b16bc(0xe2)?0x60:0xc0;if(!_0xabeea0){if(this['type']===_0x1b16bc(0xe2)&&TfLiteModel!==null){this[_0x1b16bc(0xd4)]=TfLiteModel,this[_0x1b16bc(0xd4)]['_loadModel'](0x636c0),this[_0x1b16bc(0xbc)]=this[_0x1b16bc(0xbc)][_0x1b16bc(0xc9)](this),this[_0x1b16bc(0xe5)]=this[_0x1b16bc(0xe5)][_0x1b16bc(0xc9)](this),this[_0x1b16bc(0xa8)]=this[_0x1b16bc(0xa8)]['bind'](this),this[_0x1b16bc(0xe4)]=this[_0x1b16bc(0xe4)][_0x1b16bc(0xc9)](this),this[_0x1b16bc(0xd5)]=this[_0x1b16bc(0xd5)][_0x1b16bc(0xc9)](this);return;}else{if(this['type']===_0x1b16bc(0xe8)&&TfJsModel!==null){this[_0x1b16bc(0xd4)]=TfJsModel,this[_0x1b16bc(0xbc)]=this[_0x1b16bc(0xbc)][_0x1b16bc(0xc9)](this),this[_0x1b16bc(0xe5)]=this[_0x1b16bc(0xe5)][_0x1b16bc(0xc9)](this),this['loadTfLiteModel']=this[_0x1b16bc(0xa8)]['bind'](this),this['loadTfJsModel']=this[_0x1b16bc(0xe4)][_0x1b16bc(0xc9)](this),this[_0x1b16bc(0xd5)]=this[_0x1b16bc(0xd5)][_0x1b16bc(0xc9)](this);return;}}}_0x42b364===_0x1b16bc(0xe2)?_0x4a4110()[_0x1b16bc(0xb3)](_0x540d7f=>{const _0x42e934=_0x1b16bc;_0x540d7f?(console['log']('SIMD\x20is\x20supported\x20by\x20browser'),_0x56bab8()[_0x42e934(0xb3)](_0x13ff76=>{const _0x3fbee4=_0x42e934;this[_0x3fbee4(0xa8)](_0x13ff76);})[_0x42e934(0xcf)](_0x3c910f=>{const _0x44591b=_0x42e934;this['initTime']=Date['now']()-this[_0x44591b(0xc0)],console[_0x44591b(0xb4)](_0x44591b(0xda)+_0x3c910f);})):(console[_0x42e934(0xb4)]('SIMD\x20is\x20not\x20supported\x20by\x20browser'),_0x1c8918()[_0x42e934(0xb3)](_0x4a4856=>{const _0x40d5c3=_0x42e934;this[_0x40d5c3(0xa8)](_0x4a4856);})[_0x42e934(0xcf)](_0x2ec9b3=>{const _0x82c8ab=_0x42e934;this['initTime']=Date[_0x82c8ab(0xc1)]()-this[_0x82c8ab(0xc0)],console[_0x82c8ab(0xb4)](_0x82c8ab(0xda)+_0x2ec9b3);}));})[_0x1b16bc(0xcf)](_0x1d846a=>{const _0x26386e=_0x1b16bc;console[_0x26386e(0xb4)](_0x26386e(0xb1)+_0x1d846a),_0x1c8918()[_0x26386e(0xb3)](_0x5452f8=>{const _0x17efb2=_0x26386e;this[_0x17efb2(0xa8)](_0x5452f8);})[_0x26386e(0xcf)](_0x582c7d=>{const _0x3dba59=_0x26386e;this[_0x3dba59(0xcd)]=Date[_0x3dba59(0xc1)]()-this[_0x3dba59(0xc0)],console[_0x3dba59(0xb4)](_0x3dba59(0xda)+_0x582c7d);});}):this[_0x1b16bc(0xe4)](),this[_0x1b16bc(0xbc)]=this['runTFJSInference'][_0x1b16bc(0xc9)](this),this['runTFLiteInference']=this[_0x1b16bc(0xe5)][_0x1b16bc(0xc9)](this),this['loadTfLiteModel']=this[_0x1b16bc(0xa8)]['bind'](this),this[_0x1b16bc(0xe4)]=this[_0x1b16bc(0xe4)][_0x1b16bc(0xc9)](this),this[_0x1b16bc(0xd5)]=this[_0x1b16bc(0xd5)][_0x1b16bc(0xc9)](this);}[_0x16c8d9(0xe4)](){const _0x27002b=_0x16c8d9;let _0x470ee6=_0x27002b(0xbd),_0x4db84f=new Headers(),_0x19d409={'method':'GET','headers':_0x4db84f,'mode':'cors','cache':_0x27002b(0xd0)};_0x131937['loadGraphModel'](_0x470ee6,{'requestInit':_0x19d409})[_0x27002b(0xb3)](_0x3c389d=>{const _0x58238e=_0x27002b;_0x131937[_0x58238e(0xca)](_0x58238e(0xb5)),this[_0x58238e(0xd4)]=_0x3c389d,TfJsModel=_0x3c389d,console[_0x58238e(0xb4)]('Current\x20backend\x20is:\x20'+_0x131937[_0x58238e(0xd6)]()),this[_0x58238e(0xcd)]=Date[_0x58238e(0xc1)]()-this['startTime'];})[_0x27002b(0xcf)](_0x32fadc=>{const _0x22d9ae=_0x27002b;this['initTime']=Date['now']()-this[_0x22d9ae(0xc0)],console['log']('Loading\x20model\x20error\x20due\x20to\x20'+_0x32fadc);});}[_0x16c8d9(0xa8)](_0x5dc222){const _0x53a4a3=_0x16c8d9;this[_0x53a4a3(0xd4)]=_0x5dc222,TfLiteModel=_0x5dc222;let _0x11bba4=this['model']['_getModelBufferMemoryOffset'](),_0x55886b=this[_0x53a4a3(0xd4)]['_loadModel'](0x636c0);this[_0x53a4a3(0xcd)]=Date['now']()-this[_0x53a4a3(0xc0)],console[_0x53a4a3(0xb4)](_0x53a4a3(0xc7)),console[_0x53a4a3(0xb4)](_0x53a4a3(0xbf),_0x11bba4),console[_0x53a4a3(0xb4)](_0x53a4a3(0xd7),_0x55886b),console[_0x53a4a3(0xb4)]('Input\x20memory\x20offset:',this[_0x53a4a3(0xd4)][_0x53a4a3(0xac)]()),console[_0x53a4a3(0xb4)]('Input\x20height:',this[_0x53a4a3(0xd4)][_0x53a4a3(0xcc)]()),console[_0x53a4a3(0xb4)](_0x53a4a3(0xd9),this['model']['_getInputWidth']()),console[_0x53a4a3(0xb4)](_0x53a4a3(0xb7),this[_0x53a4a3(0xd4)][_0x53a4a3(0xd2)]()),console[_0x53a4a3(0xb4)](_0x53a4a3(0xaf),this[_0x53a4a3(0xd4)]['_getOutputMemoryOffset']()),console[_0x53a4a3(0xb4)]('Output\x20height:',this['model'][_0x53a4a3(0xe6)]()),console['log'](_0x53a4a3(0xc2),this[_0x53a4a3(0xd4)]['_getOutputWidth']()),console[_0x53a4a3(0xb4)](_0x53a4a3(0xdd),this['model'][_0x53a4a3(0xe7)]());}async[_0x16c8d9(0xbc)](_0x46238d){const _0x22da2c=_0x16c8d9;let _0x136495=null;const _0x5cc10e=await _0x131937[_0x22da2c(0xe3)][_0x22da2c(0xc5)](_0x46238d[_0x22da2c(0xe9)]);try{const _0x1bcea6=_0x5cc10e[_0x22da2c(0xa9)](0x0);var _0x2914fe=await this['model']['predict'](_0x131937[_0x22da2c(0xd1)](_0x1bcea6,_0x22da2c(0xad)));_0x2914fe=_0x2914fe[_0x22da2c(0xdc)](0x3)[_0x22da2c(0xa9)](0x3);const _0x28a711=_0x2914fe[_0x22da2c(0xb0)](0x3),_0x1d7f57=_0x2914fe[_0x22da2c(0xba)](0x1),_0x1f1e32=_0x2914fe['equal'](0x2),_0x10287a=_0x28a711[_0x22da2c(0xbb)](_0x1d7f57),_0x54f1e4=_0x10287a['logicalOr'](_0x1f1e32);_0x136495=_0x131937[_0x22da2c(0xd1)](_0x54f1e4,'float32'),_0x28a711['dispose'](),_0x1d7f57['dispose'](),_0x1f1e32[_0x22da2c(0xdf)](),_0x10287a[_0x22da2c(0xdf)](),_0x54f1e4['dispose'](),_0x1bcea6[_0x22da2c(0xdf)](),_0x2914fe[_0x22da2c(0xdf)]();}catch(_0x1529f7){console[_0x22da2c(0xb4)](_0x22da2c(0xb2)+_0x1529f7);}return _0x136495;}async['runTFLiteInference'](_0x3f12d5,_0x471a89=![]){const _0x35f011=_0x16c8d9;let _0xba0172=this[_0x35f011(0xd4)][_0x35f011(0xac)]()/0x4,_0x9b6060=this[_0x35f011(0xd4)][_0x35f011(0xe1)]()/0x4,_0x67218d=_0x3f12d5[_0x35f011(0xe9)],_0x4da9b0=this[_0x35f011(0xd8)]*this[_0x35f011(0xc8)];for(let _0x3dfe48=0x0;_0x3dfe48<_0x4da9b0;_0x3dfe48++){this[_0x35f011(0xd4)]['HEAPF32'][_0xba0172+_0x3dfe48*0x3]=_0x67218d[_0x35f011(0xe9)][_0x3dfe48*0x4]/0xff,this[_0x35f011(0xd4)][_0x35f011(0xaa)][_0xba0172+_0x3dfe48*0x3+0x1]=_0x67218d[_0x35f011(0xe9)][_0x3dfe48*0x4+0x1]/0xff,this['model'][_0x35f011(0xaa)][_0xba0172+_0x3dfe48*0x3+0x2]=_0x67218d['data'][_0x3dfe48*0x4+0x2]/0xff;}this[_0x35f011(0xd4)][_0x35f011(0xcb)]();let _0x1757c5=new ImageData(this[_0x35f011(0xd8)],this[_0x35f011(0xc8)]),_0x18ecf3=new ImageData(this[_0x35f011(0xd8)],this[_0x35f011(0xc8)]);for(let _0x4da5f9=0x0;_0x4da5f9<_0x4da9b0;_0x4da5f9++){const _0xef25d6=_0x471a89?this['model']['HEAPF32'][_0x9b6060+_0x4da5f9*0x2+0x1]:this[_0x35f011(0xd4)][_0x35f011(0xaa)][_0x9b6060+_0x4da5f9*0x2],_0x1500f1=_0x471a89?this[_0x35f011(0xd4)][_0x35f011(0xaa)][_0x9b6060+_0x4da5f9*0x2]:this[_0x35f011(0xd4)][_0x35f011(0xaa)][_0x9b6060+_0x4da5f9*0x2+0x1],_0x1856ee=Math['max'](_0xef25d6,_0x1500f1),_0x20e2bc=Math[_0x35f011(0xb9)](_0xef25d6-_0x1856ee),_0x168781=Math[_0x35f011(0xb9)](_0x1500f1-_0x1856ee);_0x1757c5[_0x35f011(0xe9)][_0x4da5f9*0x4+0x3]=0xff*_0x168781/(_0x20e2bc+_0x168781),!_0x471a89&&(_0x1757c5[_0x35f011(0xe9)][_0x4da5f9*0x4+0x2]=0xff*_0x168781/(_0x20e2bc+_0x168781),_0x1757c5[_0x35f011(0xe9)][_0x4da5f9*0x4+0x1]=0xff*_0x168781/(_0x20e2bc+_0x168781),_0x1757c5[_0x35f011(0xe9)][_0x4da5f9*0x4]=0xff*_0x168781/(_0x20e2bc+_0x168781)),_0x18ecf3[_0x35f011(0xe9)][_0x4da5f9*0x4+0x3]=0xff*_0x168781/(_0x20e2bc+_0x168781);}return _0x1757c5;}async[_0x16c8d9(0xd5)](_0x4d8119,_0x92f92c,_0x3f1771=![]){const _0x383ed9=_0x16c8d9;let _0xeb7a66=null;const _0x3fe6c5=this[_0x383ed9(0xdb)]==='tflite'?0xa0:0xc0,_0x3a53ba=this[_0x383ed9(0xdb)]===_0x383ed9(0xe2)?0x60:0xc0;let _0x4d863e=await preProcessing(_0x4d8119[_0x383ed9(0xe9)],_0x92f92c,{'width':_0x4d8119[_0x383ed9(0xae)],'height':_0x4d8119[_0x383ed9(0xc6)]},ColorSpaceType[_0x383ed9(0xab)],{'width':_0x3fe6c5,'height':_0x3a53ba});if(_0x4d863e===null)return null;let _0x294a43=new ImageData(_0x4d863e,_0x3fe6c5,_0x3a53ba),_0x598ffa=PsySegBuf(_0x4d8119[_0x383ed9(0xae)],_0x4d8119[_0x383ed9(0xc6)],0x4,_0x294a43);return this['type']===_0x383ed9(0xe2)?await this['runTFLiteInference'](_0x598ffa,_0x3f1771)['then'](_0xd98f48=>{_0xeb7a66=_0xd98f48;})['catch'](_0x29bc8e=>{const _0x3fa0b8=_0x383ed9;console['log'](_0x3fa0b8(0xde)+_0x29bc8e);}):await this[_0x383ed9(0xbc)](_0x598ffa)[_0x383ed9(0xb3)](_0x154a68=>{_0xeb7a66=_0x154a68;})[_0x383ed9(0xcf)](_0x5dea39=>{const _0x3bb856=_0x383ed9;console[_0x3bb856(0xb4)](_0x3bb856(0xde)+_0x5dea39);}),_0xeb7a66;}async['release'](){const _0x22d00d=_0x16c8d9;delete this[_0x22d00d(0xd4)],delete this['segHeight'],delete this[_0x22d00d(0xd8)],delete this[_0x22d00d(0xdb)],delete this['runTFJSInference'],delete this['runTFLiteInference'],delete this['loadTfLiteModel'],delete this[_0x22d00d(0xe4)],delete this['run'];}}