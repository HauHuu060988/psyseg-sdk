const _0x462bbd=_0x1ce0;function _0x2ca5(){const _0x201177=['log','then','startTime','runTFJSInference','loadTfLiteModel','_getOutputWidth','2412508HRBsRr','cast','getBackend','Output\x20width:','_getInputChannelCount','_getInputMemoryOffset','data','setBackend','Input\x20width:','loadTfJsModel','24GsRppO','now','Create\x20tflite\x20module\x20failed\x20due\x20to\x20','373212EbDUmQ','expandDims','tflite','height','use\x20strict','HEAPF32','Input\x20channels:','fromPixels','209ndutmH','runTFLiteInference','8nDVSsS','int32','modeling\x20model','segHeight','exp','browser','loadGraphModel','type','_getModelBufferMemoryOffset','https://psyjs-cdn.nuvixa.com/model.json','catch','max','cors','initTime','756986HcWSkB','width','_getInputHeight','GET','_loadModel','segWidth','_getOutputChannelCount','bind','Cannot\x20get\x20inference\x20due\x20to\x20','greater','run','_getOutputMemoryOffset','88030ZxqHTb','SIMD\x20is\x20not\x20supported\x20by\x20browser','68883ooxLNs','Cannot\x20check\x20SIMD\x20support\x20by\x20browsers\x20due\x20to\x20','logicalOr','argMax','35uCNZbP','dispose','model','855370optVdn','Cannot\x20get\x20alpha\x20mask\x20due\x20to\x20DNN\x20issue\x20','_getInputWidth','Input\x20height:','Output\x20channels:','1087461rHDrFE','_getOutputHeight','Output\x20memory\x20offset:','release','tfjs','Model\x20load\x20result:'];_0x2ca5=function(){return _0x201177;};return _0x2ca5();}(function(_0x45425c,_0xa9799b){const _0x25a3dd=_0x1ce0,_0x275c1f=_0x45425c();while(!![]){try{const _0x35ad27=parseInt(_0x25a3dd(0x19e))/0x1+-parseInt(_0x25a3dd(0x192))/0x2+-parseInt(_0x25a3dd(0x1a0))/0x3*(-parseInt(_0x25a3dd(0x184))/0x4)+-parseInt(_0x25a3dd(0x1a4))/0x5*(parseInt(_0x25a3dd(0x1c5))/0x6)+-parseInt(_0x25a3dd(0x1b8))/0x7+parseInt(_0x25a3dd(0x1c2))/0x8*(-parseInt(_0x25a3dd(0x1ac))/0x9)+-parseInt(_0x25a3dd(0x1a7))/0xa*(-parseInt(_0x25a3dd(0x1cd))/0xb);if(_0x35ad27===_0xa9799b)break;else _0x275c1f['push'](_0x275c1f['shift']());}catch(_0x59d0f0){_0x275c1f['push'](_0x275c1f['shift']());}}}(_0x2ca5,0x3a225));import*as _0x59f3d0 from'@tensorflow/tfjs';import{PsySegBuf,ColorSpaceType}from'../PsySeg.js';function _0x1ce0(_0x43c4a7,_0x50694c){const _0x2ca5b4=_0x2ca5();return _0x1ce0=function(_0x1ce015,_0x4c5cc9){_0x1ce015=_0x1ce015-0x183;let _0x4e62e8=_0x2ca5b4[_0x1ce015];return _0x4e62e8;},_0x1ce0(_0x43c4a7,_0x50694c);}import{preProcessing}from'../Preprocessing/Preprocessing.js';import{simd}from'https://unpkg.com/wasm-feature-detect?module';import _0x366b3f from'../model/tflite-import/tflite.mjs';import _0x43b2d1 from'../model/tflite-import/tflite-simd.mjs';_0x462bbd(0x1c9);var TfLiteModel=null,TfJsModel=null;export class SmartEyes{constructor(_0x59c61e,_0x257329){const _0x50ec3a=_0x462bbd;this[_0x50ec3a(0x1b4)]=Date[_0x50ec3a(0x1c3)](),this['initTime']=0x0,this[_0x50ec3a(0x1a6)]=null,this[_0x50ec3a(0x18b)]=_0x59c61e===_0x50ec3a(0x1c7)?_0x50ec3a(0x1c7):_0x50ec3a(0x1b0),this['segWidth']=_0x59c61e===_0x50ec3a(0x1c7)?0xa0:0xc0,this[_0x50ec3a(0x187)]=_0x59c61e===_0x50ec3a(0x1c7)?0x60:0xc0;if(!_0x257329){if(this[_0x50ec3a(0x18b)]===_0x50ec3a(0x1c7)&&TfLiteModel!==null){this['model']=TfLiteModel,this['model'][_0x50ec3a(0x196)](0x636c0),this[_0x50ec3a(0x1b5)]=this[_0x50ec3a(0x1b5)]['bind'](this),this[_0x50ec3a(0x183)]=this['runTFLiteInference'][_0x50ec3a(0x199)](this),this['loadTfLiteModel']=this[_0x50ec3a(0x1b6)][_0x50ec3a(0x199)](this),this[_0x50ec3a(0x1c1)]=this[_0x50ec3a(0x1c1)][_0x50ec3a(0x199)](this),this[_0x50ec3a(0x19c)]=this[_0x50ec3a(0x19c)][_0x50ec3a(0x199)](this);return;}else{if(this[_0x50ec3a(0x18b)]===_0x50ec3a(0x1b0)&&TfJsModel!==null){this[_0x50ec3a(0x1a6)]=TfJsModel,this[_0x50ec3a(0x1b5)]=this[_0x50ec3a(0x1b5)]['bind'](this),this[_0x50ec3a(0x183)]=this[_0x50ec3a(0x183)][_0x50ec3a(0x199)](this),this[_0x50ec3a(0x1b6)]=this[_0x50ec3a(0x1b6)][_0x50ec3a(0x199)](this),this['loadTfJsModel']=this['loadTfJsModel'][_0x50ec3a(0x199)](this),this[_0x50ec3a(0x19c)]=this[_0x50ec3a(0x19c)][_0x50ec3a(0x199)](this);return;}}}_0x59c61e===_0x50ec3a(0x1c7)?simd()[_0x50ec3a(0x1b3)](_0x16569b=>{const _0x6241dc=_0x50ec3a;_0x16569b?(console[_0x6241dc(0x1b2)]('SIMD\x20is\x20supported\x20by\x20browser'),_0x43b2d1()[_0x6241dc(0x1b3)](_0x55396d=>{const _0x526142=_0x6241dc;this[_0x526142(0x1b6)](_0x55396d);})[_0x6241dc(0x18e)](_0x36f19e=>{const _0x2f09ff=_0x6241dc;this[_0x2f09ff(0x191)]=Date[_0x2f09ff(0x1c3)]()-this['startTime'],console['log'](_0x2f09ff(0x1c4)+_0x36f19e);})):(console[_0x6241dc(0x1b2)](_0x6241dc(0x19f)),_0x366b3f()[_0x6241dc(0x1b3)](_0x4f7215=>{const _0x5a5205=_0x6241dc;this[_0x5a5205(0x1b6)](_0x4f7215);})['catch'](_0x2a0da3=>{const _0x4238b9=_0x6241dc;this[_0x4238b9(0x191)]=Date[_0x4238b9(0x1c3)]()-this[_0x4238b9(0x1b4)],console[_0x4238b9(0x1b2)](_0x4238b9(0x1c4)+_0x2a0da3);}));})['catch'](_0xb888a8=>{const _0x31a8d1=_0x50ec3a;console['log'](_0x31a8d1(0x1a1)+_0xb888a8),_0x366b3f()[_0x31a8d1(0x1b3)](_0x2b50b5=>{this['loadTfLiteModel'](_0x2b50b5);})[_0x31a8d1(0x18e)](_0x2b26f9=>{const _0x9f81af=_0x31a8d1;this['initTime']=Date[_0x9f81af(0x1c3)]()-this[_0x9f81af(0x1b4)],console[_0x9f81af(0x1b2)]('Create\x20tflite\x20module\x20failed\x20due\x20to\x20'+_0x2b26f9);});}):this[_0x50ec3a(0x1c1)](),this[_0x50ec3a(0x1b5)]=this[_0x50ec3a(0x1b5)][_0x50ec3a(0x199)](this),this[_0x50ec3a(0x183)]=this[_0x50ec3a(0x183)][_0x50ec3a(0x199)](this),this[_0x50ec3a(0x1b6)]=this[_0x50ec3a(0x1b6)][_0x50ec3a(0x199)](this),this[_0x50ec3a(0x1c1)]=this['loadTfJsModel'][_0x50ec3a(0x199)](this),this['run']=this['run'][_0x50ec3a(0x199)](this);}[_0x462bbd(0x1c1)](){const _0x317d82=_0x462bbd;let _0xcbf0ee=_0x317d82(0x18d),_0x43202d=new Headers(),_0x1b6c54={'method':_0x317d82(0x195),'headers':_0x43202d,'mode':_0x317d82(0x190),'cache':'default'};_0x59f3d0[_0x317d82(0x18a)](_0xcbf0ee,{'requestInit':_0x1b6c54})[_0x317d82(0x1b3)](_0x3e4216=>{const _0xf4ba9f=_0x317d82;_0x59f3d0[_0xf4ba9f(0x1bf)]('webgl'),this[_0xf4ba9f(0x1a6)]=_0x3e4216,TfJsModel=_0x3e4216,console[_0xf4ba9f(0x1b2)]('Current\x20backend\x20is:\x20'+_0x59f3d0[_0xf4ba9f(0x1ba)]()),this[_0xf4ba9f(0x191)]=Date['now']()-this[_0xf4ba9f(0x1b4)];})['catch'](_0x26282e=>{const _0x50ca6c=_0x317d82;this['initTime']=Date[_0x50ca6c(0x1c3)]()-this[_0x50ca6c(0x1b4)],console['log']('Loading\x20model\x20error\x20due\x20to\x20'+_0x26282e);});}['loadTfLiteModel'](_0x1060a9){const _0x1efeea=_0x462bbd;this['model']=_0x1060a9,TfLiteModel=_0x1060a9;let _0x3832fb=this[_0x1efeea(0x1a6)][_0x1efeea(0x18c)](),_0x20f165=this[_0x1efeea(0x1a6)][_0x1efeea(0x196)](0x636c0);this[_0x1efeea(0x191)]=Date['now']()-this[_0x1efeea(0x1b4)],console[_0x1efeea(0x1b2)](_0x1efeea(0x186)),console['log']('Model\x20buffer\x20memory\x20offset:',_0x3832fb),console[_0x1efeea(0x1b2)](_0x1efeea(0x1b1),_0x20f165),console[_0x1efeea(0x1b2)]('Input\x20memory\x20offset:',this[_0x1efeea(0x1a6)][_0x1efeea(0x1bd)]()),console[_0x1efeea(0x1b2)](_0x1efeea(0x1aa),this[_0x1efeea(0x1a6)][_0x1efeea(0x194)]()),console[_0x1efeea(0x1b2)](_0x1efeea(0x1c0),this[_0x1efeea(0x1a6)][_0x1efeea(0x1a9)]()),console[_0x1efeea(0x1b2)](_0x1efeea(0x1cb),this[_0x1efeea(0x1a6)][_0x1efeea(0x1bc)]()),console['log'](_0x1efeea(0x1ae),this[_0x1efeea(0x1a6)][_0x1efeea(0x19d)]()),console[_0x1efeea(0x1b2)]('Output\x20height:',this[_0x1efeea(0x1a6)][_0x1efeea(0x1ad)]()),console['log'](_0x1efeea(0x1bb),this['model'][_0x1efeea(0x1b7)]()),console[_0x1efeea(0x1b2)](_0x1efeea(0x1ab),this[_0x1efeea(0x1a6)][_0x1efeea(0x198)]());}async[_0x462bbd(0x1b5)](_0x1371a1){const _0x1d4731=_0x462bbd;let _0x5ae68e=null;const _0xc0e807=await _0x59f3d0[_0x1d4731(0x189)][_0x1d4731(0x1cc)](_0x1371a1[_0x1d4731(0x1be)]);try{const _0x3603b1=_0xc0e807[_0x1d4731(0x1c6)](0x0);var _0x4a9a3b=await this[_0x1d4731(0x1a6)]['predict'](_0x59f3d0[_0x1d4731(0x1b9)](_0x3603b1,_0x1d4731(0x185)));_0x4a9a3b=_0x4a9a3b[_0x1d4731(0x1a3)](0x3)[_0x1d4731(0x1c6)](0x3);const _0x106ab7=_0x4a9a3b[_0x1d4731(0x19b)](0x3),_0x405da4=_0x4a9a3b['equal'](0x1),_0x253819=_0x4a9a3b['equal'](0x2),_0x197b10=_0x106ab7[_0x1d4731(0x1a2)](_0x405da4),_0x191c07=_0x197b10[_0x1d4731(0x1a2)](_0x253819);_0x5ae68e=_0x59f3d0[_0x1d4731(0x1b9)](_0x191c07,'float32'),_0x106ab7[_0x1d4731(0x1a5)](),_0x405da4[_0x1d4731(0x1a5)](),_0x253819[_0x1d4731(0x1a5)](),_0x197b10[_0x1d4731(0x1a5)](),_0x191c07[_0x1d4731(0x1a5)](),_0x3603b1[_0x1d4731(0x1a5)](),_0x4a9a3b[_0x1d4731(0x1a5)]();}catch(_0x370c1a){console[_0x1d4731(0x1b2)](_0x1d4731(0x1a8)+_0x370c1a);}return _0x5ae68e;}async[_0x462bbd(0x183)](_0x4bbd26,_0x27c90d=![]){const _0x395ae5=_0x462bbd;let _0x494e84=this['model'][_0x395ae5(0x1bd)]()/0x4,_0x13f5bb=this[_0x395ae5(0x1a6)]['_getOutputMemoryOffset']()/0x4,_0x5d05af=_0x4bbd26[_0x395ae5(0x1be)],_0x193eb0=this[_0x395ae5(0x197)]*this[_0x395ae5(0x187)];for(let _0x2109de=0x0;_0x2109de<_0x193eb0;_0x2109de++){this[_0x395ae5(0x1a6)][_0x395ae5(0x1ca)][_0x494e84+_0x2109de*0x3]=_0x5d05af[_0x395ae5(0x1be)][_0x2109de*0x4]/0xff,this[_0x395ae5(0x1a6)][_0x395ae5(0x1ca)][_0x494e84+_0x2109de*0x3+0x1]=_0x5d05af['data'][_0x2109de*0x4+0x1]/0xff,this[_0x395ae5(0x1a6)][_0x395ae5(0x1ca)][_0x494e84+_0x2109de*0x3+0x2]=_0x5d05af[_0x395ae5(0x1be)][_0x2109de*0x4+0x2]/0xff;}this[_0x395ae5(0x1a6)]['_runInference']();let _0x59676d=new ImageData(this[_0x395ae5(0x197)],this[_0x395ae5(0x187)]),_0x4fbd42=new ImageData(this[_0x395ae5(0x197)],this[_0x395ae5(0x187)]);for(let _0x273dd3=0x0;_0x273dd3<_0x193eb0;_0x273dd3++){const _0x148713=_0x27c90d?this[_0x395ae5(0x1a6)][_0x395ae5(0x1ca)][_0x13f5bb+_0x273dd3*0x2+0x1]:this[_0x395ae5(0x1a6)][_0x395ae5(0x1ca)][_0x13f5bb+_0x273dd3*0x2],_0x237178=_0x27c90d?this[_0x395ae5(0x1a6)][_0x395ae5(0x1ca)][_0x13f5bb+_0x273dd3*0x2]:this[_0x395ae5(0x1a6)]['HEAPF32'][_0x13f5bb+_0x273dd3*0x2+0x1],_0x3d23bf=Math[_0x395ae5(0x18f)](_0x148713,_0x237178),_0x5208d4=Math[_0x395ae5(0x188)](_0x148713-_0x3d23bf),_0x27a009=Math['exp'](_0x237178-_0x3d23bf);_0x59676d[_0x395ae5(0x1be)][_0x273dd3*0x4+0x3]=0xff*_0x27a009/(_0x5208d4+_0x27a009),!_0x27c90d&&(_0x59676d[_0x395ae5(0x1be)][_0x273dd3*0x4+0x2]=0xff*_0x27a009/(_0x5208d4+_0x27a009),_0x59676d[_0x395ae5(0x1be)][_0x273dd3*0x4+0x1]=0xff*_0x27a009/(_0x5208d4+_0x27a009),_0x59676d['data'][_0x273dd3*0x4]=0xff*_0x27a009/(_0x5208d4+_0x27a009)),_0x4fbd42[_0x395ae5(0x1be)][_0x273dd3*0x4+0x3]=0xff*_0x27a009/(_0x5208d4+_0x27a009);}return _0x59676d;}async[_0x462bbd(0x19c)](_0x3b9b9d,_0x4e8f2b,_0x4b1b4e=![]){const _0x49cb77=_0x462bbd;let _0x581efb=null;const _0x31ad1b=this[_0x49cb77(0x18b)]==='tflite'?0xa0:0xc0,_0x413b91=this['type']===_0x49cb77(0x1c7)?0x60:0xc0;let _0x234360=await preProcessing(_0x3b9b9d[_0x49cb77(0x1be)],_0x4e8f2b,{'width':_0x3b9b9d[_0x49cb77(0x193)],'height':_0x3b9b9d[_0x49cb77(0x1c8)]},ColorSpaceType['COLOR_SPACE_RGBA'],{'width':_0x31ad1b,'height':_0x413b91});if(_0x234360===null)return null;let _0x29c3a4=new ImageData(_0x234360,_0x31ad1b,_0x413b91),_0x50185d=PsySegBuf(_0x3b9b9d[_0x49cb77(0x193)],_0x3b9b9d[_0x49cb77(0x1c8)],0x4,_0x29c3a4);return this['type']===_0x49cb77(0x1c7)?await this[_0x49cb77(0x183)](_0x50185d,_0x4b1b4e)[_0x49cb77(0x1b3)](_0x3208eb=>{_0x581efb=_0x3208eb;})[_0x49cb77(0x18e)](_0x599b05=>{const _0x353137=_0x49cb77;console[_0x353137(0x1b2)](_0x353137(0x19a)+_0x599b05);}):await this['runTFJSInference'](_0x50185d)[_0x49cb77(0x1b3)](_0x12aaed=>{_0x581efb=_0x12aaed;})['catch'](_0x1ee900=>{const _0x3866b6=_0x49cb77;console[_0x3866b6(0x1b2)](_0x3866b6(0x19a)+_0x1ee900);}),_0x581efb;}async[_0x462bbd(0x1af)](){const _0x33b532=_0x462bbd;delete this['model'],delete this[_0x33b532(0x187)],delete this[_0x33b532(0x197)],delete this[_0x33b532(0x18b)],delete this[_0x33b532(0x1b5)],delete this['runTFLiteInference'],delete this[_0x33b532(0x1b6)],delete this[_0x33b532(0x1c1)],delete this['run'];}}