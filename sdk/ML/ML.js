const _0x45ab6f=_0x5f35;(function(_0x7ecb60,_0x52e46e){const _0x32bced=_0x5f35,_0x1cae4a=_0x7ecb60();while(!![]){try{const _0x3344c2=parseInt(_0x32bced(0xf2))/0x1+parseInt(_0x32bced(0x101))/0x2+parseInt(_0x32bced(0x128))/0x3+parseInt(_0x32bced(0x125))/0x4*(-parseInt(_0x32bced(0x100))/0x5)+-parseInt(_0x32bced(0x119))/0x6*(-parseInt(_0x32bced(0xfa))/0x7)+parseInt(_0x32bced(0xed))/0x8+parseInt(_0x32bced(0x12e))/0x9*(-parseInt(_0x32bced(0x113))/0xa);if(_0x3344c2===_0x52e46e)break;else _0x1cae4a['push'](_0x1cae4a['shift']());}catch(_0x562599){_0x1cae4a['push'](_0x1cae4a['shift']());}}}(_0x101a,0x3ff6b));function _0x5f35(_0x36ca73,_0x54102a){const _0x101ac5=_0x101a();return _0x5f35=function(_0x5f3525,_0x5873d5){_0x5f3525=_0x5f3525-0xea;let _0x375b2f=_0x101ac5[_0x5f3525];return _0x375b2f;},_0x5f35(_0x36ca73,_0x54102a);}import*as _0x454e60 from'@tensorflow/tfjs';import{PsySegBuf,ColorSpaceType}from'../PsySeg.js';import{preProcessing}from'../Preprocessing/Preprocessing.js';import*as _0x291826 from'wasm-check';import _0x51a3b7 from'../model/tflite-import/tflite.mjs';function _0x101a(){const _0x470568=['predict','Output\x20width:','_getOutputChannelCount','bind','_getOutputWidth','Input\x20width:','equal','tflite','60XPuIOO','dispose','model','210114HsvrRR','feature','setBackend','Loading\x20model\x20error\x20due\x20to\x20','Cannot\x20get\x20inference\x20due\x20to\x20','_loadModel','225lgzSZb','expandDims','segHeight','startTime','use\x20strict','runTFLiteInference','3871368wCdKPc','greater','tfjs','exp','_getInputChannelCount','216417XbBJFR','runTFJSInference','Model\x20buffer\x20memory\x20offset:','max','getBackend','_getOutputHeight','Model\x20load\x20result:','Create\x20tflite\x20module\x20failed\x20due\x20to\x20','115913GsNmVL','_getOutputMemoryOffset','segWidth','GET','HEAPF32','loadTfLiteModel','93305nhkdlB','956372svHAeu','type','argMax','logicalOr','_getInputWidth','float32','modeling\x20model','log','int32','data','width','webgl','catch','SIMD\x20is\x20not\x20supported\x20by\x20browser','simd','Input\x20height:','then','run','428380bBGWsY','cast','_getInputMemoryOffset','browser','loadTfJsModel','Input\x20memory\x20offset:','132PqWEAP','https://psyjs-cdn.nuvixa.com/model.json','initTime','now'];_0x101a=function(){return _0x470568;};return _0x101a();}import _0x1bbf8a from'../model/tflite-import/tflite-simd.mjs';_0x45ab6f(0xeb);var TfLiteModel=null,TfJsModel=null;export class SmartEyes{constructor(_0x1a08ef,_0x5e86e5){const _0x4c90ba=_0x45ab6f;this[_0x4c90ba(0xea)]=Date[_0x4c90ba(0x11c)](),this[_0x4c90ba(0x11b)]=0x0,this[_0x4c90ba(0x127)]=null,this[_0x4c90ba(0x102)]=_0x1a08ef===_0x4c90ba(0x124)?_0x4c90ba(0x124):_0x4c90ba(0xef),this['segWidth']=_0x1a08ef===_0x4c90ba(0x124)?0xa0:0xc0,this[_0x4c90ba(0x130)]=_0x1a08ef==='tflite'?0x60:0xc0;if(!_0x5e86e5){if(this['type']===_0x4c90ba(0x124)&&TfLiteModel!==null){this[_0x4c90ba(0x127)]=TfLiteModel,this[_0x4c90ba(0x127)][_0x4c90ba(0x12d)](0x636c0),this[_0x4c90ba(0xf3)]=this['runTFJSInference']['bind'](this),this[_0x4c90ba(0xec)]=this[_0x4c90ba(0xec)]['bind'](this),this[_0x4c90ba(0xff)]=this[_0x4c90ba(0xff)][_0x4c90ba(0x120)](this),this[_0x4c90ba(0x117)]=this['loadTfJsModel'][_0x4c90ba(0x120)](this),this[_0x4c90ba(0x112)]=this[_0x4c90ba(0x112)]['bind'](this);return;}else{if(this[_0x4c90ba(0x102)]==='tfjs'&&TfJsModel!==null){this[_0x4c90ba(0x127)]=TfJsModel,this[_0x4c90ba(0xf3)]=this[_0x4c90ba(0xf3)][_0x4c90ba(0x120)](this),this[_0x4c90ba(0xec)]=this[_0x4c90ba(0xec)]['bind'](this),this[_0x4c90ba(0xff)]=this[_0x4c90ba(0xff)][_0x4c90ba(0x120)](this),this[_0x4c90ba(0x117)]=this['loadTfJsModel']['bind'](this),this[_0x4c90ba(0x112)]=this[_0x4c90ba(0x112)][_0x4c90ba(0x120)](this);return;}}}if(_0x1a08ef==='tflite')try{_0x291826[_0x4c90ba(0x129)][_0x4c90ba(0x10f)]?(console[_0x4c90ba(0x108)]('SIMD\x20is\x20supported\x20by\x20browser'),_0x1bbf8a()[_0x4c90ba(0x111)](_0x2aaaf2=>{const _0x429de4=_0x4c90ba;this[_0x429de4(0xff)](_0x2aaaf2);})[_0x4c90ba(0x10d)](_0x2cb792=>{const _0x3e0301=_0x4c90ba;this['initTime']=Date['now']()-this['startTime'],console[_0x3e0301(0x108)](_0x3e0301(0xf9)+_0x2cb792);})):(console['log'](_0x4c90ba(0x10e)),_0x51a3b7()['then'](_0x5ac3b4=>{const _0x28f0a8=_0x4c90ba;this[_0x28f0a8(0xff)](_0x5ac3b4);})['catch'](_0x2a9d7a=>{const _0x238b26=_0x4c90ba;this['initTime']=Date[_0x238b26(0x11c)]()-this[_0x238b26(0xea)],console['log'](_0x238b26(0xf9)+_0x2a9d7a);}));}catch(_0x3deff5){console[_0x4c90ba(0x108)]('Cannot\x20check\x20SIMD\x20support\x20by\x20browsers\x20due\x20to\x20'+_0x3deff5),_0x51a3b7()[_0x4c90ba(0x111)](_0x4e6ef3=>{this['loadTfLiteModel'](_0x4e6ef3);})[_0x4c90ba(0x10d)](_0x27d483=>{const _0x3454e2=_0x4c90ba;this['initTime']=Date[_0x3454e2(0x11c)]()-this[_0x3454e2(0xea)],console['log'](_0x3454e2(0xf9)+_0x27d483);});}else this[_0x4c90ba(0x117)]();this[_0x4c90ba(0xf3)]=this[_0x4c90ba(0xf3)]['bind'](this),this['runTFLiteInference']=this[_0x4c90ba(0xec)][_0x4c90ba(0x120)](this),this[_0x4c90ba(0xff)]=this[_0x4c90ba(0xff)][_0x4c90ba(0x120)](this),this[_0x4c90ba(0x117)]=this['loadTfJsModel'][_0x4c90ba(0x120)](this),this['run']=this[_0x4c90ba(0x112)]['bind'](this);}[_0x45ab6f(0x117)](){const _0x51a289=_0x45ab6f;let _0x224cce=_0x51a289(0x11a),_0x59a029=new Headers(),_0x305c67={'method':_0x51a289(0xfd),'headers':_0x59a029,'mode':'cors','cache':'default'};_0x454e60['loadGraphModel'](_0x224cce,{'requestInit':_0x305c67})[_0x51a289(0x111)](_0x547d8d=>{const _0x1e5ca2=_0x51a289;_0x454e60[_0x1e5ca2(0x12a)](_0x1e5ca2(0x10c)),this[_0x1e5ca2(0x127)]=_0x547d8d,TfJsModel=_0x547d8d,console[_0x1e5ca2(0x108)]('Current\x20backend\x20is:\x20'+_0x454e60[_0x1e5ca2(0xf6)]()),this[_0x1e5ca2(0x11b)]=Date[_0x1e5ca2(0x11c)]()-this[_0x1e5ca2(0xea)];})[_0x51a289(0x10d)](_0xc6fc28=>{const _0xbdd9f2=_0x51a289;this[_0xbdd9f2(0x11b)]=Date[_0xbdd9f2(0x11c)]()-this['startTime'],console[_0xbdd9f2(0x108)](_0xbdd9f2(0x12b)+_0xc6fc28);});}['loadTfLiteModel'](_0x297987){const _0x341b83=_0x45ab6f;this[_0x341b83(0x127)]=_0x297987,TfLiteModel=_0x297987;let _0x3769fd=this[_0x341b83(0x127)]['_getModelBufferMemoryOffset'](),_0x436417=this[_0x341b83(0x127)][_0x341b83(0x12d)](0x636c0);this[_0x341b83(0x11b)]=Date['now']()-this['startTime'],console[_0x341b83(0x108)](_0x341b83(0x107)),console[_0x341b83(0x108)](_0x341b83(0xf4),_0x3769fd),console[_0x341b83(0x108)](_0x341b83(0xf8),_0x436417),console[_0x341b83(0x108)](_0x341b83(0x118),this[_0x341b83(0x127)][_0x341b83(0x115)]()),console[_0x341b83(0x108)](_0x341b83(0x110),this[_0x341b83(0x127)]['_getInputHeight']()),console[_0x341b83(0x108)](_0x341b83(0x122),this['model'][_0x341b83(0x105)]()),console['log']('Input\x20channels:',this[_0x341b83(0x127)][_0x341b83(0xf1)]()),console[_0x341b83(0x108)]('Output\x20memory\x20offset:',this[_0x341b83(0x127)][_0x341b83(0xfb)]()),console[_0x341b83(0x108)]('Output\x20height:',this[_0x341b83(0x127)][_0x341b83(0xf7)]()),console[_0x341b83(0x108)](_0x341b83(0x11e),this[_0x341b83(0x127)][_0x341b83(0x121)]()),console[_0x341b83(0x108)]('Output\x20channels:',this[_0x341b83(0x127)][_0x341b83(0x11f)]());}async['runTFJSInference'](_0x48668c){const _0x164655=_0x45ab6f;let _0x22474d=null;const _0x5d1ec8=await _0x454e60[_0x164655(0x116)]['fromPixels'](_0x48668c[_0x164655(0x10a)]);try{const _0xcbe06c=_0x5d1ec8[_0x164655(0x12f)](0x0);var _0x588dc4=await this[_0x164655(0x127)][_0x164655(0x11d)](_0x454e60[_0x164655(0x114)](_0xcbe06c,_0x164655(0x109)));_0x588dc4=_0x588dc4[_0x164655(0x103)](0x3)[_0x164655(0x12f)](0x3);const _0x110c7f=_0x588dc4[_0x164655(0xee)](0x3),_0x3a97ee=_0x588dc4['equal'](0x1),_0x58b011=_0x588dc4[_0x164655(0x123)](0x2),_0x571704=_0x110c7f['logicalOr'](_0x3a97ee),_0x423818=_0x571704[_0x164655(0x104)](_0x58b011);_0x22474d=_0x454e60['cast'](_0x423818,_0x164655(0x106)),_0x110c7f['dispose'](),_0x3a97ee[_0x164655(0x126)](),_0x58b011[_0x164655(0x126)](),_0x571704[_0x164655(0x126)](),_0x423818[_0x164655(0x126)](),_0xcbe06c[_0x164655(0x126)](),_0x588dc4['dispose']();}catch(_0x52a092){console[_0x164655(0x108)]('Cannot\x20get\x20alpha\x20mask\x20due\x20to\x20DNN\x20issue\x20'+_0x52a092);}return _0x22474d;}async[_0x45ab6f(0xec)](_0x2278e4,_0x3782cf=![]){const _0x52e6a8=_0x45ab6f;let _0x26d7dc=this[_0x52e6a8(0x127)][_0x52e6a8(0x115)]()/0x4,_0x1b578a=this[_0x52e6a8(0x127)][_0x52e6a8(0xfb)]()/0x4,_0x55176a=_0x2278e4[_0x52e6a8(0x10a)],_0x2e7bd9=this[_0x52e6a8(0xfc)]*this[_0x52e6a8(0x130)];for(let _0x413e7b=0x0;_0x413e7b<_0x2e7bd9;_0x413e7b++){this[_0x52e6a8(0x127)]['HEAPF32'][_0x26d7dc+_0x413e7b*0x3]=_0x55176a[_0x52e6a8(0x10a)][_0x413e7b*0x4]/0xff,this[_0x52e6a8(0x127)][_0x52e6a8(0xfe)][_0x26d7dc+_0x413e7b*0x3+0x1]=_0x55176a[_0x52e6a8(0x10a)][_0x413e7b*0x4+0x1]/0xff,this['model']['HEAPF32'][_0x26d7dc+_0x413e7b*0x3+0x2]=_0x55176a[_0x52e6a8(0x10a)][_0x413e7b*0x4+0x2]/0xff;}this['model']['_runInference']();let _0x5ac261=new ImageData(this[_0x52e6a8(0xfc)],this['segHeight']),_0x56307e=new ImageData(this[_0x52e6a8(0xfc)],this[_0x52e6a8(0x130)]);for(let _0x2c66d8=0x0;_0x2c66d8<_0x2e7bd9;_0x2c66d8++){const _0x47441f=_0x3782cf?this[_0x52e6a8(0x127)][_0x52e6a8(0xfe)][_0x1b578a+_0x2c66d8*0x2+0x1]:this[_0x52e6a8(0x127)][_0x52e6a8(0xfe)][_0x1b578a+_0x2c66d8*0x2],_0x29300c=_0x3782cf?this[_0x52e6a8(0x127)][_0x52e6a8(0xfe)][_0x1b578a+_0x2c66d8*0x2]:this[_0x52e6a8(0x127)][_0x52e6a8(0xfe)][_0x1b578a+_0x2c66d8*0x2+0x1],_0x14d856=Math[_0x52e6a8(0xf5)](_0x47441f,_0x29300c),_0x3b754f=Math[_0x52e6a8(0xf0)](_0x47441f-_0x14d856),_0x7123=Math['exp'](_0x29300c-_0x14d856);_0x5ac261[_0x52e6a8(0x10a)][_0x2c66d8*0x4+0x3]=0xff*_0x7123/(_0x3b754f+_0x7123),!_0x3782cf&&(_0x5ac261[_0x52e6a8(0x10a)][_0x2c66d8*0x4+0x2]=0xff*_0x7123/(_0x3b754f+_0x7123),_0x5ac261[_0x52e6a8(0x10a)][_0x2c66d8*0x4+0x1]=0xff*_0x7123/(_0x3b754f+_0x7123),_0x5ac261['data'][_0x2c66d8*0x4]=0xff*_0x7123/(_0x3b754f+_0x7123)),_0x56307e['data'][_0x2c66d8*0x4+0x3]=0xff*_0x7123/(_0x3b754f+_0x7123);}return _0x5ac261;}async[_0x45ab6f(0x112)](_0x2a5a5b,_0x40767d,_0x3b824c=![]){const _0x203741=_0x45ab6f;let _0x453005=null;const _0x3df04f=this[_0x203741(0x102)]===_0x203741(0x124)?0xa0:0xc0,_0x47dd23=this['type']===_0x203741(0x124)?0x60:0xc0;let _0x575a1a=await preProcessing(_0x2a5a5b[_0x203741(0x10a)],_0x40767d,{'width':_0x2a5a5b['width'],'height':_0x2a5a5b['height']},ColorSpaceType['COLOR_SPACE_RGBA'],{'width':_0x3df04f,'height':_0x47dd23});if(_0x575a1a===null)return null;let _0x31cf05=new ImageData(_0x575a1a,_0x3df04f,_0x47dd23),_0x31ee72=PsySegBuf(_0x2a5a5b[_0x203741(0x10b)],_0x2a5a5b['height'],0x4,_0x31cf05);return this[_0x203741(0x102)]===_0x203741(0x124)?await this['runTFLiteInference'](_0x31ee72,_0x3b824c)['then'](_0x51e2f2=>{_0x453005=_0x51e2f2;})['catch'](_0x213703=>{console['log']('Cannot\x20get\x20inference\x20due\x20to\x20'+_0x213703);}):await this[_0x203741(0xf3)](_0x31ee72)['then'](_0x3c288d=>{_0x453005=_0x3c288d;})[_0x203741(0x10d)](_0x274af7=>{const _0xdff46e=_0x203741;console[_0xdff46e(0x108)](_0xdff46e(0x12c)+_0x274af7);}),_0x453005;}async['release'](){const _0x26be9e=_0x45ab6f;delete this[_0x26be9e(0x127)],delete this[_0x26be9e(0x130)],delete this['segWidth'],delete this['type'],delete this['runTFJSInference'],delete this[_0x26be9e(0xec)],delete this[_0x26be9e(0xff)],delete this[_0x26be9e(0x117)],delete this[_0x26be9e(0x112)];}}